!function(){var a=window.App=Ember.Application.create();a.firebaseRef=new Firebase("https://glaring-fire-2767.firebaseio.com"),a.ApplicationAdapter=DS.FirebaseAdapter.extend({firebase:a.firebaseRef}),a.ApplicationSerializer=DS.FirebaseSerializer.extend(),a.UserProfile=Ember.Object.extend({}),a.userProfile=a.UserProfile.create({loginFailed:!1,isProcessing:!1,isSlowConnection:!1,timeout:null}),a.auth=new FirebaseSimpleLogin(a.firebaseRef,function(b,c){b?(console.log("there was a problem. Error is: ",b),clearTimeout(a.userProfile.get("timeout")),a.userProfile.set("loginFailed",!0),a.userProfile.set("loginError",b.message),a.userProfile.set("isProcessing",!1),a.userProfile.set("isSlowConnection",!1),console.log("there was a problem. App.userProfile is: ",a.userProfile)):c?(console.log("User ID: "+c.id+", Provider: "+c.provider),clearTimeout(a.userProfile.get("timeout")),a.userProfile.set("loginFailed",!1),a.userProfile.set("isProcessing",!1),a.userProfile.set("isSlowConnection",!1),a.userProfile.set("user",c),console.log("great success. App.userProfile is: ",a.userProfile)):console.log("I'm not logged in so give me some options to log in please")})}(),function(){App.AccountController=Ember.ObjectController.extend({actions:{register:function(){console.log("SIGN UP clicked. model in AccountController before manipulation is: ",this.get("model")),this.set("model.isProcessing",!0),this.set("model.loginFailed",!1),this.set("model.timeout",setTimeout(this.slowConnection.bind(this.get("model")),5e3)),console.log("model in AccountController after manipulation is: ",this.get("model"));var a=this;App.auth.createUser(this.get("email"),this.get("password"),function(b,c){b?(console.log("there was an error in registration: ",b),clearTimeout(a.get("model.timeout")),a.set("model.isProcessing",!1),a.set("model.isSlowConnection",!1),a.set("model.loginFailed",!0)):(console.log("successfully registered!"),console.log("User Id: "+c.id+", Email: "+c.email),clearTimeout(a.get("model.timeout")),a.set("model.isProcessing",!1),a.set("model.isSlowConnection",!1),a.set("model.user",c),console.log("great success. App.userProfile is: ",App.userProfile))}),this.clearForm()},login:function(){console.log("login clicked. model in AccountController before manipulation is: ",this.get("model")),this.set("model.isProcessing",!0),this.set("model.loginFailed",!1),this.set("model.timeout",setTimeout(this.slowConnection.bind(this.get("model")),5e3)),console.log("model in AccountController after manipulation is: ",this.get("model")),App.auth.login("password",{email:this.get("email"),password:this.get("password")}),this.clearForm()},loginFacebook:function(){App.auth.login("facebook",{scope:"email"}),this.clearForm()},loginTwitter:function(){App.auth.login("twitter"),this.clearForm()},logout:function(){App.auth.logout(),App.userProfile.set("user",null),this.clearForm()}},slowConnection:function(){this.set("model.isSlowConnection",!0)},clearForm:function(){this.set("email",""),this.set("password","")}})}(),function(){App.ApplicationController=Ember.ObjectController.extend({needs:"properties"})}(),function(){App.MyhomesController=Ember.ArrayController.extend({sortProperties:["clickDate"],sortAscending:!1})}(),function(){App.ProfileController=Ember.ObjectController.extend({})}(),function(){App.PropertiesController=Ember.ArrayController.extend({needs:"application",application:Ember.computed.alias("controllers.application"),init:function(){this._super(),console.log("inside PropertiesController with model ",this.get("model"))},actions:{saveProperty:function(a){var b={address:a.get("address"),price:a.get("price"),picture:a.get("picture"),bedrooms:a.get("bedrooms"),bathrooms:a.get("bathrooms"),squarefeet:a.get("squarefeet"),yearBuilt:a.get("yearBuilt"),description:a.get("description"),id:a.get("id"),saved:!0,clickDate:Date.now()};b=this.store.createRecord("myhomes",b),console.log("this is home to be saved inside saveProperty ",b),b.save()},lookupAddress:function(a){this.set("application.searchParams",a?a:"Greenville, SC");var b=new google.maps.Geocoder,c=this;b.geocode({address:this.get("application.searchParams")},function(a,b){if(b==google.maps.GeocoderStatus.OK){var d=(a[0].geometry.location,a[0].geometry.location.d),e=a[0].geometry.location.e;console.log("searchParams latlon: ",d,", ",e),c.loadMap(d,e)}else console.log("Geocode was not successful for the following reason: ",b)})}},loadMap:function(a,b){console.log("loading the map with coords: ",a,", ",b),mapCanvas=$("#map-canvas")[0];var c={center:new google.maps.LatLng(a,b),zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:this.mapStyles};this.set("googleMap",new google.maps.Map(mapCanvas,c)),this.pullInstagrams(a,b);var d=this;this.get("model").forEach(function(a){d.setMarkers(a)})},pullInstagrams:function(a,b){var c=this;$.ajax({url:"https://api.instagram.com/v1/media/search?lat="+a+"&lng="+b+"&distance=2000&client_id=371ca2f6cfb64bfe9c71847cc6fe52c5&callback=?",dataType:"jsonp",success:function(a){a.data.forEach(function(a){c.mapInstagram(a)})},error:function(){console.log("Bummer, something is wrong in pullInstagrams function.")}})},mapInstagram:function(a){console.log("about to run each function over instagram results"),console.log(a," : ",a.images.thumbnail.url);{var b=this,c=a.location.latitude,d=a.location.longitude,e=new google.maps.LatLng(c,d),f={url:"https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcTd_z4ttYllDoWctnMGoRg8nD1wb8udfbtthirjurZtnLvrp1cm",size:new google.maps.Size(30,30),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,32)};new google.maps.Marker({map:b.get("googleMap"),title:a.caption?a.caption.text:"(no caption)",position:e,icon:f})}},setMarkers:function(a){var b=this,c=new google.maps.Geocoder;c.geocode({address:a.get("address")},function(c,d){if(d==google.maps.GeocoderStatus.OK){var e="address: "+a.get("address")+" price: "+a.get("price"),f=new google.maps.Marker({map:b.get("googleMap"),title:e,position:c[0].geometry.location});google.maps.event.addListener(f,"click",function(){b.transitionToRoute("property",a.get("id"))})}else console.log("Geocode was not successful for the following reason: ",d)})},mapStyles:[{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#F5A9A9"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#F5A9A9"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#46BDBD"}]},{featureType:"landscape.man_made",stylers:[{color:"#E5E3D3"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#B8B6B1"}]},{featureType:"water",stylers:[{color:"#16F2F2"}]}]})}(),function(){App.PropertyController=Ember.ObjectController.extend({init:function(){},actions:{printModel:function(){console.log("we are inside PropertyController: ",this.get("model"))}}})}(),function(){var a=DS.attr;App.Myhomes=DS.Model.extend({property_id:a("number"),address:a("string"),saved:a("boolean"),clickDate:a("number"),bathrooms:a("number"),bedrooms:a("number"),description:a("string"),price:a("number"),squarefeet:a("number"),yearBuilt:a("string"),picture:a("string")})}(),function(){var a=DS.attr;App.Properties=DS.Model.extend({address:a("string"),bathrooms:a("number"),bedrooms:a("number"),picture:a("string"),description:a("string"),property_id:a("number"),price:a("number"),squarefeet:a("number"),yearBuilt:a("string")})}(),function(){var a=DS.attr;App.Property=DS.Model.extend({property_id:a("number"),address:a("string"),saved:a("boolean")})}(),function(){App.AccountRoute=Ember.Route.extend({model:function(){return App.userProfile},setupController:function(a,b){a.set("model",b)}})}(),function(){App.ApplicationRoute=Ember.Route.extend({model:function(){return App.userProfile}})}(),function(){App.MyhomesRoute=Ember.Route.extend({model:function(){return this.store.findAll("myhomes")},afterModel:function(){App.userProfile.user||this.transitionTo("account")}})}(),function(){App.ProfileRoute=Ember.Route.extend({model:function(){return App.userProfile.get("user")},afterModel:function(a){a||this.transitionTo("account")}})}(),function(){App.PropertiesRoute=Ember.Route.extend({renderTemplate:function(){this._super(),console.log("renderTemplate fired")},model:function(){return this.store.findAll("properties")},setupController:function(a,b){a.set("model",b)}})}(),function(){App.PropertyRoute=Ember.Route.extend({model:function(a){return console.log("PropertyRoute fired with params: ",a),this.store.find("properties",a.property_id)},setupController:function(a,b){a.set("model",b)}})}(),function(){App.ApplicationView=Ember.View.extend({didInsertElement:function(){$("#drawer").mmenu({},{selectedClass:"active"})}})}(),function(){App.MyhomesView=Ember.View.extend({})}(),function(){App.PropertiesView=Ember.View.extend({didInsertElement:function(){this.get("controller").send("lookupAddress",this.controller.get("application.searchParams"))}})}(),function(){App.PropertyView=Ember.View.extend({didInsertElement:function(){this.pullInstagrams()},pullInstagrams:function(){var a,b,c,d=this,e=new google.maps.Geocoder;e.geocode({address:this.controller.get("address")},function(e,f){f==google.maps.GeocoderStatus.OK?(a=e[0].geometry.location,console.log("latlon: ",a),b=e[0].geometry.location.d,c=e[0].geometry.location.e,$.ajax({url:"https://api.instagram.com/v1/media/search?lat="+b+"&lng="+c+"&distance=1000&client_id=371ca2f6cfb64bfe9c71847cc6fe52c5&callback=?",dataType:"jsonp",success:function(a){d.controller.set("instagramPhotos",a.data),console.log("instagram photos have been set ",d.controller.get("instagramPhotos"))},error:function(){console.log("Bummer, something is wrong in pullInstagrams function inside PropertyController.")}})):console.log("Geocode was not successful for the following reason: ",f)})}})}(),function(){App.Router.map(function(){this.route("style-guide"),this.route("account"),this.resource("properties"),this.resource("property",{path:"/:property_id"}),this.resource("myhomes")}),App.Router.reopen({rootURL:"/neighborgood/"})}(),function(){$(function(){}),$(document).on("scroll",function(){$(".navigation-bar").toggleClass("foggy",$(document).scrollTop()>40)})}();